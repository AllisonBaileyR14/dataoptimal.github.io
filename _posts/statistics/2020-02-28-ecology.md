---
title: "Population Growth Rate Project"
date: 2020-02-20
tags: [data wrangling, data science, messy data]
header:
  image: "/images/us_map.jpg"
excerpt: "Data Wrangling, Data Science, Messy Data"
mathjax: "true"
---

## Growth Rate and Population Density Analysis

<img src="{{ site.url }}{{ site.baseurl }}/images/globe_build.jpg">

There are two types of population growth in the environment. The first is exponential growth, where there resources are unlimited (density-independent growth).  The second is logistical growth, where resources are limited (density-dependent growth). 

To project annual population growth rate with population density data, you can use the formula *ln Nt - ln No/t = r* which also remember that r = dN/Ndt.

Reminder:
Nt = No e^rt where Nt = population size at time t; No = original population size, r = intrinsic rate of increase and t = time

The graph below visualizes the population density and growth rate for specified countries:
<img src="{{ site.url }}{{ site.baseurl }}/images/pop_density.png" width = "100%">

Below is a multiple linear regression of the effect of education levels and caloric intake on population growth rate: 
<img src="{{ site.url }}{{ site.baseurl }}/images/pop.png" width = "100%">
After running a multiple linear regression below, it was found that caloric intake does not play a critical role in a population's growth rate.  For this reason, I will conduct further analysis of daily caloric intake and years of education separately. 

The graph below visualizes the population density and growth rate for Argentina and China. The red dots reflect the carrying capacity (K) for each country:
<img src="{{ site.url }}{{ site.baseurl }}/images/china_density.png" width = "100%">

Below is a multiple linear regression on the effect of caloric intake on population growth rate: 
<img src="{{ site.url }}{{ site.baseurl }}/images/cal_star.png" width = "100%">
Caloric intake does not play a critical role in a population's growth rate.  This was also confirmed through an AIC test, where it was proven that education level is a more significant variable to determine growth rate. Furthermore, the findings on the multilinear regression model found the coefficient value of calories to be 0.

Below is a multiple linear regression of the effect of education levels on population growth rate: 
<img src="{{ site.url }}{{ site.baseurl }}/images/ed.png" width = "100%">

After analyzing the data through multiple linear regression to explore relationships between dN/Ndt (a continuous outcome variable) and the predictor variable of education level and country described below:

•	dN/Ndt - a continuous quantitative variable

•	Education Level - a categorical variable with 12 levels

•	Country - a categorical variable with 5 levels

Running multiple linear regression, we find the following regression equation:

dN/Ndt(Education Level, Country) = 1.380e-02 - 1.020e-03(years_ed) +  1.704e-03(Canada) - -2.040e-03(China) - 2.247e-03(India) + 4.544e-03(Kenya).

Further interpretations of each coefficient:

* -1.020e-03(years_ed): If everything else is held constant, we would expect a 1.020e-03 decrease in dN/Ndt for each level of increase in education level.

* 1.704e-03(Canada): If everything else about the variables is the same (education level), we would expect Canada dN/Ndt to be 1.704e-03 higher than the average.

* -2.040e-03(China): If everything else about the variables is the same (education level), we would expect China dN/Ndt to be - 2.040e-03 lower than the average.

* -2.247e-03(India): If everything else about the variables is the same (education level), we would expect India dN/Ndt to be - 2.247e-03 lower than the average.

* 4.544e-03(Kenya): If everything else about the variables is the same (education level), we would expect Kenya dN/Ndt to be 4.544e-03 higher than the average.


The graph visualizes the socioeconomic variable of caloric intake (daily Kcal) and its effects on growth rate:
<img src="{{ site.url }}{{ site.baseurl }}/images/education.png" width = "100%">


The graph below visualizes the socioeconomic variable of education level and its effects on growth rate.:
<img src="{{ site.url }}{{ site.baseurl }}/images/calorie.png" width = "100%">

The graph below visualizes GDP and its effects on growth rate in Kenya:
<img src="{{ site.url }}{{ site.baseurl }}/images/kenya.png" width = "100%">

Below is a multiple linear regression of the effect of gdp levels on population growth rate:
<img src="{{ site.url }}{{ site.baseurl }}/images/gdp.png" width = "100%">
GDP does not play a critical role in a population's growth rate.  This was also confirmed through an AIC test, where it was proven that education level is a more significant variable to determine growth rate. Furthermore, the findings on the multilinear regression model found the coefficient value of calories to be 0.

Here is the R Markdown document to how these graphs and statistical analysis was produced:
<iframe width="100%" height="500px" src="../images/ecology_homework_bailey.html" class="cool"></iframe>

Here is the reproducible code:
```r
# Attach packages

library(tidyverse)
library(janitor)
library(naniar)
library(VIM)
library(skimr)
library(ggfortify)
library(here)
library(lubridate)
library(anytime)
library(ggridges)
library(viridis)
library(hrbrthemes)
library(paletteer)
library(kableExtra)
library(ggpubr)
library(sf)
library(tmap)
library(DT)
library(plotly)
library(expss)
library(ggthemes)
library(knitr)
library(gridExtra)
library(stargazer)

# read in csv "assig1_data.csv"

country_data <- read_csv("assig1_data.csv")

# Calculate the dN/Ndt for each country from 1963 to 1964 for each country.

country_rate <- country_data %>%
  filter(year == "1963" | year == "1964")

# First, let's start with Argentina

Argentina <- (log(x = 22020001) - log(x = 21690001))/1
# Answer: 0.0151


# Now calcuate Canada

Canada <-  (log(x = 19309001) - log(x = 18965001))/1
# Answer: 0.018

# Now calculate China

China <-  (log(x = 703333001) - log(x = 687913001))/1
# Answer: 0.022

# Now calculate India

India <-  (log(x = 486639001) - log(x = 476632001))/1
# Answer: 0.021

# Now calculate Kenya

Kenya <-  (log(x = 9198001) - log(x = 8906001))/1

# Answer: 0.032

# Now make a table that shows the different countries dN/Ndt compared to what was given

country_table <- matrix(c(0.0151,0.0065, 0.018, 0.00786, 0.022, 0.01034,0.021,0.0099, 0.032, 0.013940849),ncol=2,byrow=TRUE)
colnames(country_table) <- c("New dN/Ndt","Given dN/Ndt")
rownames(country_table) <- c("Argentina","Canada","China", "India", "Kenya")
country_table_final <- as.table(country_table)


kable(country_table_final, col.names = c("New dN/Ndt","Given dN/Ndt"),
      caption = "***Figure 1.** The table below displays the rate of population change (dN/Ndt) between raw calculation with population data and data provided*") %>% 
  kable_styling(bootstrap_options = "striped") %>%
  add_header_above(c("Rate of Population Change from 1963 to 1964" = 3))
  
country_jitter <- ggplot(country_data, aes(x = population, y = dNNdt)) +
  geom_point(aes(color = country)) +
   theme_light() +
  theme(
    legend.position="none",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text(hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic')
  ) +
  theme(axis.text.x = element_text( 
    angle = 45, 
    size=6),
    axis.text.y = element_text(size=8)
  ) +
  labs(x = "Population Density",
       y = "dNNdt",
       title = "dN/Ndt vs. Population Density",
       subtitle = "Country Comparison of Population Density and Growth Rate") +
  facet_wrap(~country, scales = "free")

country_jitter

# Extra Credit

extra_jitter <- ggplot(country_data, aes(x = population, y = dNNdt, size = calories_pd, color = year)) +
  geom_point() +
   theme_light() +
  theme(
    legend.position="right",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text(hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic')
  ) +
  theme(axis.text.x = element_text( 
    angle = 45, 
    size=6),
    axis.text.y = element_text(size=8)
  ) +
  labs(x = "Population Density",
       y = "dNNdt",
       title = "dN/Ndt vs. Population Density",
       subtitle = "Comparison of daily calories by year") +
  facet_wrap(~country, scales = "free") +
  labs(
         color = "Year",
         size = "Daily Calorie Intake"
        )

extra_jitter

# In class we showed what the plot of dN/Ndt versus population density should look like. For each country

# 1, plot dN/Ndt vs Nt. 

arg_china_pop <- country_data %>%
  dplyr::select(country, year, population, dNNdt) %>%
  filter(country == "Argentina" | country == "China")
  
china_pop <- arg_china_pop %>%
  filter(country == "China")

china_jitter <- ggplot(china_pop, aes(x = population, y = dNNdt)) +
  geom_point() +
  xlim(660993001, 1560000000) +
  stat_smooth(method = "lm", fullrange = TRUE) +
  annotate("pointrange", x = 1560000000, y = 0, xmin = 1500000000, xmax = 1600000000, ymin = 0, ymax = 0,colour = "red", size = 1.5, alpha=0.4) +
   theme_light() +
  theme(
    legend.position="right",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text(hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic')
  ) +
  labs(x = "Population Density(bil)",
       y = "dNNdt",
       title = "China: dN/Ndt vs. Population Density",
       subtitle = "Comparison of Population Density and Growth Rate")



arg_pop <- arg_china_pop %>%
  filter(country == "Argentina")

arg_jitter <- ggplot(arg_pop, aes(x = population, y = dNNdt)) +
  geom_point() +
  xlim(21021001, 68000000) +
  stat_smooth(method = "lm", fullrange = TRUE) +
  annotate("pointrange", x = 68000000, y = 0, xmin = 62000000, xmax = 70000000, ymin = 0, ymax = 0,colour = "red", size = 1.5, alpha=0.4) +
  theme_light() +
  theme(
    legend.position="right",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text(hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic')
  ) +
  labs(x = "Population Density(mil)",
       y = "dNNdt",
       title = "Argentina: dN/Ndt vs. Population Density",
       subtitle = "Comparison of Population Density and Growth Rate")

# I wanted to change the scale from sci-notation to basic numbers.  But was having a difficult time since I extended the scale.  However, this code DOES work. scale_x_continuous(breaks = c(2e+07, 3e+07, 4e+07, 5e+07, 6e+07), labels = c("20", "30", "40", "50", "60")) 

grid.arrange(china_jitter, arg_jitter, nrow = 2)

# Extra Credit

arg_pop_extra <- country_data %>%
  dplyr::select(year, country, dNNdt, calories_pd) %>%
  filter(country == "Argentina")


ggplot(arg_pop_extra, aes(x= population, y= dNNdt)) +
   geom_point(aes(color = year, size = calories_pd), alpha = 0.5) +
  scale_color_manual() +
  scale_size(range = c(0.5, 12)) # Adjust the range of points size

arg_jitter_extra

country_roll <- country_data %>%
  group_by(year, country, calories_pd, years_ed) %>%
  drop_na()
  

calories_mlr <- lm(dNNdt ~ calories_pd, data = country_roll)

ed_mlr <- lm(dNNdt ~ years_ed, data = country_roll)

total_mlr <- lm(dNNdt ~ years_ed + calories_pd, data = country_roll)

# Is there an interactive effect of caloric intake on Growth Rate?

# AIC(calories_mlr)
# AIC(ed_mlr)


total_order_plot <- ggplot(country_roll, aes(x=population, y=dNNdt, size = calories_pd, color = years_ed)) +
  geom_point() +
  geom_smooth(method = "lm") +
  theme_gray() +
  scale_fill_viridis() +
  scale_color_viridis() +
  theme(
    legend.position="right",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text( hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic'))

total_order_plot

calorie_order_plot <- ggplot(country_roll, aes(x=calories_pd, y=dNNdt)) +
  geom_point(aes(color = country)) +
  geom_smooth(method = "lm", scales = "free") +
  theme_gray() +
  theme(
    legend.position="right",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text(hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic')
  ) +
  labs(x = "Caloric Intake",
       y = "dN/Ndt",
       title = "Caloric Intake vs. dNNdt",
       subtitle = "Effects of Caloric intake on Growth Rate")

calorie_order_plot

total_mlr <- lm(dNNdt ~ years_ed + calories_pd, data = country_roll)

stargazer(total_mlr, title="Results", align=TRUE, type = 'html')

# Show the mlr's in a stargazer table for education vs dN/Ndt

stargazer(calories_mlr, title="Results", align=TRUE, type = 'html')

education_order_plot <- ggplot(country_roll, aes(x=years_ed, y=dNNdt)) +
  geom_point(aes(color = country)) +
  geom_smooth(method = "lm", scales = "free") +
  theme_minimal() +
  theme(
    legend.position="right",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text(hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic')
  ) +
  labs(x = "Years of Education",
       y = "dNNdt",
       title = "Education vs. dN/Ndt",
       subtitle = "Effects of Education Level on Growth Rate")

education_order_plot

# Show the mlr's in a stargazer table for education vs dN/Ndt

stargazer(ed_mlr, title="Results", align=TRUE, type = 'html')

gdp <- country_data %>%
  dplyr::select(country, GDP_pc, year, dNNdt) 

gdp_kenya <- country_data %>%
  dplyr::select(country, GDP_pc, year, dNNdt) %>%
  filter(country == "Kenya")

gdp_order_plot <- ggplot(gdp_kenya, aes(x=GDP_pc, y=dNNdt)) +
  geom_point() +
  geom_smooth(method = "lm", scales = "free") +
  theme_gray() +
  theme(
    legend.position="right",
    plot.title = element_text(size=14)
  ) +
  theme(
    plot.title=element_text(hjust=0.5, vjust=0.5, face='bold'),
    plot.subtitle = element_text(hjust=0.5, vjust=0.5, face='italic')
  ) +
  labs(x = "GDP",
       y = "dNNdt",
       title = "Kenya: GDP Level vs. dN/Ndt",
       subtitle = "Affects of Kenya's GDP Level on Growth Rate")

gdp_order_plot

gdp_mlr <- lm(dNNdt ~ GDP_pc + country, data = gdp)

# Show the mlr's in a stargazer table for gdp vs dN/Ndt

stargazer(gdp_mlr, title="Results", align=TRUE, type = 'html')


```
